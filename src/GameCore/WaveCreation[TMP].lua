---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Bergi.
--- DateTime: 14.02.2021 23:57
---

do
    TimerStart(CreateTimer(), 1, false, function()
        TempEnemyID={FourCC("nsko"),FourCC("nsog"),FourCC("nsoc"),FourCC("nsko"),FourCC("nsog"),FourCC("nsoc")}
        effPenta="Hive\\Magic CirclePentagram\\Magic CirclePentagram Fire\\MagicCircle_Fire.mdl"
        --print("start")
        LiveOnWave={}
        StartWave(1,10)

    end)
end

function CreateCreepDelay(id,x,y,delay,k)
    local eff=AddSpecialEffect(effPenta,x,y)
    TimerStart(CreateTimer(),delay, false, function()
        --print("create new")
        local new=CreateUnit(Player(1),id,x,y,GetRandomInt(0,360))
        IssueTargetOrder(new,"attack",HERO[0].UnitHero)
        DestroyEffect(eff)
        TimerStart(CreateTimer(),delay, true, function()
            if not UnitAlive(new) then
                DestroyTimer(GetExpiredTimer())
                LiveOnWave[k]=LiveOnWave[k]-1
                --print(LiveOnWave[k])
            end
        end)
    end)
end

function StartWave(k,max)
   -- print("start wave "..max)
    LiveOnWave[k]=max
    --print(0)
    for i = 0, max do
        --print(1)
        local loc=GetRandomLocInRect(gg_rct_R1)
        --print(2)
        local x,y=GetLocationX(loc),GetLocationY(loc)
        --print(i)
        CreateCreepDelay(TempEnemyID[k],x,y,1.5,k)
    end
    TimerStart(CreateTimer(),1, true, function()
        if LiveOnWave[k]<0 then
            --print("все убиты, стартуем новую волну")
            DestroyTimer(GetExpiredTimer())
            StartWave(k+1,10)
        end
    end)
end